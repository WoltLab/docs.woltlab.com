<!DOCTYPE html>
<head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="">
<meta name="keywords" content=" ">
<title>Migrating from WSC 3.1 - Form Builder | WoltLab Suite 5.3 Documentation</title>

<link rel="stylesheet" href="https://docs.woltlab.com/5.3/css/syntax.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,300,600">
<link rel="stylesheet" href="https://docs.woltlab.com/5.3/css/font-awesome.min.css">
<!--<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">-->
<link rel="stylesheet" href="https://docs.woltlab.com/5.3/css/modern-business.css">
<link rel="stylesheet" href="https://docs.woltlab.com/5.3/css/lavish-bootstrap.css">
<link rel="stylesheet" href="https://docs.woltlab.com/5.3/css/customstyles.css">
<link rel="stylesheet" href="https://docs.woltlab.com/5.3/css/theme-blue.css?v=3">

<script src="https://docs.woltlab.com/5.3/js/jquery.min.js"></script>
<script src="https://docs.woltlab.com/5.3/js/jquery.cookie.min.js"></script>
<script src="https://docs.woltlab.com/5.3/js/jquery.navgoco.min.js"></script>
<script src="https://docs.woltlab.com/5.3/js/bootstrap.min.js"></script>
<script src="https://docs.woltlab.com/5.3/js/anchor.min.js"></script>
<script src="https://docs.woltlab.com/5.3/js/toc.js"></script>
<script src="https://docs.woltlab.com/5.3/js/customscripts.js"></script>

<link rel="shortcut icon" href="https://docs.woltlab.com/5.3/images/favicon.ico">

<link rel="alternate" type="application/rss+xml" title="docs.woltlab.com" href="https://docs.woltlab.com/5.3feed.xml">

    <script>
        $(document).ready(function() {
            // Initialize navgoco with default options
            $("#mysidebar").navgoco({
                caretHtml: '',
                accordion: true,
                openClass: 'active', // open
                save: false, // leave false or nav highlighting doesn't work right
                cookie: {
                    name: 'navgoco',
                    expires: false,
                    path: '/'
                },
                slide: {
                    duration: 400,
                    easing: 'swing'
                }
            });

            $("#collapseAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', false);
            });

            $("#expandAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', true);
            });

        });

    </script>
    <script>
        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        })
    </script>
    

</head>
<body>
  <!-- Navigation -->
<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="container topnavlinks">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="fa fa-home fa-lg navbar-brand" href="index.html">&nbsp;<span class="projectTitle"> WoltLab Suite 5.3 Documentation</span></a>
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <!-- entries without drop-downs appear here -->
                
                
                
                <li><a href="https://www.woltlab.com" target="_blank">woltlab.com</a></li>
                
                
                
                
                
                <li><a href="https://github.com/WoltLab/WCF/" target="_blank">Code on github.com</a></li>
                
                
                
                <!-- entries with drop-downs appear here -->
                <!-- conditional logic to control which topnav appears for the audience defined in the configuration file.-->
                
                
                <!--comment out this block if you want to hide search-->
                <li>
                    <!--start search-->
                    <div id="search-demo-container">
                        <input type="text" id="search-input" placeholder="search...">
                        <ul id="results-container"></ul>
                    </div>
                    <script src="https://docs.woltlab.com/5.3/js/jekyll-search.js" type="text/javascript"></script>
                    <script type="text/javascript">
                            SimpleJekyllSearch.init({
                                searchInput: document.getElementById('search-input'),
                                resultsContainer: document.getElementById('results-container'),
                                dataSource: 'https://docs.woltlab.com/5.3/search.json',
                                searchResultTemplate: '<li><a href="{url}" title="Migrating from WSC 3.1 - Form Builder">{title}</a></li>',
                    noResultsText: 'No results found.',
                            limit: 10,
                            fuzzy: true,
                    })
                    </script>
                    <!--end search-->
                </li>
            </ul>
        </div>
        </div>
        <!-- /.container -->
</nav>


  <div class="container">
    <div class="col-lg-12">&nbsp;</div>

    <div class="row">
      <div class="col-md-3">
        


<ul id="mysidebar" class="nav">
    <li class="sidebarTitle">WoltLab Suite 5.3</li>

    
        
            <li>
                <a href="#">Getting Started</a>
                <ul>
                    
                        
                            
                            
                                <li data-identifier="index"><a href="index.html">Introduction</a></li>
                            
                        

                        
                    
                        
                            
                            
                                <li data-identifier="getting-started_quick-start"><a href="getting-started_quick-start.html">Quick Start</a></li>
                            
                        

                        
                    
                </ul>
            </li>
        
            <li>
                <a href="#">PHP API</a>
                <ul>
                    
                        
                            
                            
                                <li data-identifier="php_pages"><a href="php_pages.html">Pages</a></li>
                            
                        

                        
                    
                        
                            
                            
                                <li data-identifier="php_database-objects"><a href="php_database-objects.html">Database Objects</a></li>
                            
                        

                        
                    
                        
                            
                            
                                <li data-identifier="php_database-access"><a href="php_database-access.html">Database Access</a></li>
                            
                        

                        
                    
                        
                            
                            
                                <li data-identifier="php_exceptions"><a href="php_exceptions.html">Exceptions</a></li>
                            
                        

                        
                    
                        

                        
                            <li class="subfolders">
                                <a href="#">API</a>
                                <ul>
                                    
                                        
                                        
                                            <li data-identifier="php_api_caches"><a href="php_api_caches.html">Caches</a></li>
                                        
                                    
                                        
                                        
                                            <li data-identifier="php_api_comments"><a href="php_api_comments.html">Comments</a></li>
                                        
                                    
                                        
                                        
                                            <li data-identifier="php_api_cronjobs"><a href="php_api_cronjobs.html">Cronjobs</a></li>
                                        
                                    
                                        
                                        
                                            <li data-identifier="php_api_events"><a href="php_api_events.html">Events</a></li>
                                        
                                    
                                        
                                        
                                            <li data-identifier="php_api_form_builder"><a href="php_api_form_builder.html">Form Builder</a></li>
                                        
                                    
                                        
                                        
                                            <li data-identifier="php_api_package_installation_plugins"><a href="php_api_package_installation_plugins.html">Package Installation Plugins</a></li>
                                        
                                    
                                        
                                        
                                            <li data-identifier="php_api_user_activity_points"><a href="php_api_user_activity_points.html">User Activity Points</a></li>
                                        
                                    
                                        
                                        
                                            <li data-identifier="php_api_user_notifications"><a href="php_api_user_notifications.html">User Notifications</a></li>
                                        
                                    
                                        
                                        
                                            <li data-identifier="php_api_sitemaps"><a href="php_api_sitemaps.html">Sitemaps</a></li>
                                        
                                    
                                </ul>
                            </li>
                        
                    
                        
                            
                            
                                <li data-identifier="php_code-style"><a href="php_code-style.html">Code Style</a></li>
                            
                        

                        
                    
                        
                            
                            
                                <li data-identifier="php_apps"><a href="php_apps.html">Apps</a></li>
                            
                        

                        
                    
                        
                            
                            
                                <li data-identifier="php_gdpr"><a href="php_gdpr.html">GDPR</a></li>
                            
                        

                        
                    
                </ul>
            </li>
        
            <li>
                <a href="#">Languages, Templates & CSS</a>
                <ul>
                    
                        
                            
                            
                                <li data-identifier="view_languages"><a href="view_languages.html">Languages</a></li>
                            
                        

                        
                    
                        
                            
                            
                                <li data-identifier="view_templates"><a href="view_templates.html">Templates</a></li>
                            
                        

                        
                    
                        
                            
                            
                                <li data-identifier="view_css"><a href="view_css.html">CSS</a></li>
                            
                        

                        
                    
                </ul>
            </li>
        
            <li>
                <a href="#">JavaScript API</a>
                <ul>
                    
                        
                            
                            
                                <li data-identifier="javascript_general-usage"><a href="javascript_general-usage.html">General Usage</a></li>
                            
                        

                        
                    
                        

                        
                            <li class="subfolders">
                                <a href="#">New API</a>
                                <ul>
                                    
                                        
                                        
                                            <li data-identifier="javascript_new-api_writing-a-module"><a href="javascript_new-api_writing-a-module.html">Writing a module</a></li>
                                        
                                    
                                        
                                        
                                            <li data-identifier="javascript_new-api_data-structures"><a href="javascript_new-api_data-structures.html">Data Structures</a></li>
                                        
                                    
                                        
                                        
                                            <li data-identifier="javascript_new-api_core"><a href="javascript_new-api_core.html">Core Functions</a></li>
                                        
                                    
                                        
                                        
                                            <li data-identifier="javascript_new-api_dom"><a href="javascript_new-api_dom.html">DOM</a></li>
                                        
                                    
                                        
                                        
                                            <li data-identifier="javascript_new-api_events"><a href="javascript_new-api_events.html">Event Handling</a></li>
                                        
                                    
                                        
                                        
                                            <li data-identifier="javascript_new-api_ajax"><a href="javascript_new-api_ajax.html">Ajax</a></li>
                                        
                                    
                                        
                                        
                                            <li data-identifier="javascript_new-api_dialogs"><a href="javascript_new-api_dialogs.html">Dialogs</a></li>
                                        
                                    
                                        
                                        
                                            <li data-identifier="javascript_new-api_browser"><a href="javascript_new-api_browser.html">Browser and Screen Sizes</a></li>
                                        
                                    
                                        
                                        
                                            <li data-identifier="javascript_new-api_ui"><a href="javascript_new-api_ui.html">User Interface</a></li>
                                        
                                    
                                </ul>
                            </li>
                        
                    
                        
                            
                            
                                <li data-identifier="javascript_legacy-api"><a href="javascript_legacy-api.html">Legacy API</a></li>
                            
                        

                        
                    
                        
                            
                            
                                <li data-identifier="javascript_helper-functions"><a href="javascript_helper-functions.html">Helper Functions</a></li>
                            
                        

                        
                    
                        
                            
                            
                                <li data-identifier="javascript_code-snippets"><a href="javascript_code-snippets.html">Code Snippets</a></li>
                            
                        

                        
                    
                </ul>
            </li>
        
            <li>
                <a href="#">Package Components</a>
                <ul>
                    
                        
                            
                            
                                <li data-identifier="package_package-xml"><a href="package_package-xml.html">package.xml</a></li>
                            
                        

                        
                    
                        
                            
                            
                                <li data-identifier="package_pip"><a href="package_pip.html">PIPs</a></li>
                            
                        

                        
                    
                </ul>
            </li>
        
            <li>
                <a href="#">Migration</a>
                <ul>
                    
                        

                        
                            <li class="subfolders">
                                <a href="#">Migrating from WSC 5.2</a>
                                <ul>
                                    
                                        
                                        
                                            <li data-identifier="migration_wsc-52_php"><a href="migration_wsc-52_php.html">PHP API</a></li>
                                        
                                    
                                        
                                        
                                            <li data-identifier="migration_wsc-52_templates"><a href="migration_wsc-52_templates.html">Templates and Languages</a></li>
                                        
                                    
                                        
                                        
                                            <li data-identifier="migration_wsc-52_libraries"><a href="migration_wsc-52_libraries.html">Third Party Libraries</a></li>
                                        
                                    
                                </ul>
                            </li>
                        
                            <li class="subfolders">
                                <a href="#">Migrating from WSC 3.1</a>
                                <ul>
                                    
                                        
                                        
                                            <li data-identifier="migration_wsc-31_php"><a href="migration_wsc-31_php.html">PHP API</a></li>
                                        
                                    
                                </ul>
                            </li>
                        
                            <li class="subfolders">
                                <a href="#">Migrating from WSC 3.0</a>
                                <ul>
                                    
                                        
                                        
                                            <li data-identifier="migration_wsc-30_php"><a href="migration_wsc-30_php.html">PHP API</a></li>
                                        
                                    
                                        
                                        
                                            <li data-identifier="migration_wsc-30_javascript"><a href="migration_wsc-30_javascript.html">JavaScript API</a></li>
                                        
                                    
                                        
                                        
                                            <li data-identifier="migration_wsc-30_templates"><a href="migration_wsc-30_templates.html">Templates</a></li>
                                        
                                    
                                        
                                        
                                            <li data-identifier="migration_wsc-30_css"><a href="migration_wsc-30_css.html">CSS</a></li>
                                        
                                    
                                        
                                        
                                            <li data-identifier="migration_wsc-30_package"><a href="migration_wsc-30_package.html">Package Components</a></li>
                                        
                                    
                                </ul>
                            </li>
                        
                            <li class="subfolders">
                                <a href="#">Migrating from WCF 2.1</a>
                                <ul>
                                    
                                        
                                        
                                            <li data-identifier="migration_wcf-21_php"><a href="migration_wcf-21_php.html">PHP API</a></li>
                                        
                                    
                                        
                                        
                                            <li data-identifier="migration_wcf-21_templates"><a href="migration_wcf-21_templates.html">Templates</a></li>
                                        
                                    
                                        
                                        
                                            <li data-identifier="migration_wcf-21_css"><a href="migration_wcf-21_css.html">CSS</a></li>
                                        
                                    
                                        
                                        
                                            <li data-identifier="migration_wcf-21_package"><a href="migration_wcf-21_package.html">Package Components</a></li>
                                        
                                    
                                </ul>
                            </li>
                        
                    
                </ul>
            </li>
        
            <li>
                <a href="#">Tutorials</a>
                <ul>
                    
                        
                            
                            
                                <li data-identifier="tutorial_tutorial-series"><a href="tutorial_tutorial-series.html">Tutorial Series</a></li>
                            
                        

                        
                    
                </ul>
            </li>
        
    
</ul>

<script>
(function() {
    var sidebar = $('#mysidebar');
    var item = sidebar.find('.active');
    if (item.length === 0) {
        var parent = 'migration_wsc-31_php';
        if (parent) {
            sidebar.find('li[data-identifier="' + parent + '"]').addClass('active');
        }
    }

    sidebar.find(".active").parents('li').toggleClass("active");
})();
</script>

      </div>

      <div class="col-md-9">
        <div class="bs-callout bs-callout-info">This version of the documentation for WoltLab Suite 5.3 is outdated. Please refer to <a href="https://docs.woltlab.com/latest/">the latest version</a>.</div>

        <div class="post-header">
   <h1 class="post-title-main">Migrating from WSC 3.1 - Form Builder</h1>
</div>



<div class="post-content">

   

    
    
<!-- this handles the automatic toc. use ## for subheads to auto-generate the on-page minitoc. if you use html tags, you must supply an ID for the heading element in order for it to appear in the minitoc. -->
<script>
$( document ).ready(function() {
  // Handler for .ready() called.

$('#toc').toc({ minimumHeaders: 0, listType: 'ul', showSpeed: 0, headers: 'h2,h3,h4' });

/* this offset helps account for the space taken up by the floating toolbar. */
$('#toc').on('click', 'a', function() {
  var target = $(this.getAttribute('href'))
    , scroll_target = target.offset().top

  $(window).scrollTop(scroll_target - 10);
  return false
})
  
});
</script>

<div id="toc"></div>

    
    
  <h2 id="example-two-text-form-fields">Example: Two Text Form Fields</h2>

<p>As the first example, the pre-WoltLab Suite Core 5.2 versions of the forms to add and edit persons from the <a href="tutorial_tutorial-series_part-1-base-structure.html">first part of the tutorial series</a> will be updated to the new form builder API.
This form is the perfect first examples as it is very simple with only two text fields whose only restriction is that they have to be filled out and that their values may not be longer than 255 characters each.</p>

<p>As a reminder, here are the two relevant PHP files and the relevant template file:</p>

<figure class="highlight"><pre><code class="language-php" data-lang="php"><span class="cp">&lt;?php</span>
<span class="kn">namespace</span> <span class="nn">wcf\acp\form</span><span class="p">;</span>
<span class="kn">use</span> <span class="nn">wcf\data\person\PersonAction</span><span class="p">;</span>
<span class="kn">use</span> <span class="nn">wcf\form\AbstractForm</span><span class="p">;</span>
<span class="kn">use</span> <span class="nn">wcf\system\exception\UserInputException</span><span class="p">;</span>
<span class="kn">use</span> <span class="nn">wcf\system\WCF</span><span class="p">;</span>
<span class="kn">use</span> <span class="nn">wcf\util\StringUtil</span><span class="p">;</span>

<span class="cd">/**
 * Shows the form to create a new person.
 * 
 * @author	Matthias Schmidt
 * @copyright	2001-2019 WoltLab GmbH
 * @license	GNU Lesser General Public License &lt;http://opensource.org/licenses/lgpl-license.php&gt;
 * @package	WoltLabSuite\Core\Acp\Form
 */</span>
<span class="kd">class</span> <span class="nc">PersonAddForm</span> <span class="k">extends</span> <span class="nx">AbstractForm</span> <span class="p">{</span>
	<span class="cd">/**
	 * @inheritDoc
	 */</span>
	<span class="k">public</span> <span class="nv">$activeMenuItem</span> <span class="o">=</span> <span class="s1">'wcf.acp.menu.link.person.add'</span><span class="p">;</span>
	
	<span class="cd">/**
	 * first name of the person
	 * @var	string
	 */</span>
	<span class="k">public</span> <span class="nv">$firstName</span> <span class="o">=</span> <span class="s1">''</span><span class="p">;</span>
	
	<span class="cd">/**
	 * last name of the person
	 * @var	string
	 */</span>
	<span class="k">public</span> <span class="nv">$lastName</span> <span class="o">=</span> <span class="s1">''</span><span class="p">;</span>
	
	<span class="cd">/**
	 * @inheritDoc
	 */</span>
	<span class="k">public</span> <span class="nv">$neededPermissions</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'admin.content.canManagePeople'</span><span class="p">];</span>
	
	<span class="cd">/**
	 * @inheritDoc
	 */</span>
	<span class="k">public</span> <span class="k">function</span> <span class="nf">assignVariables</span><span class="p">()</span> <span class="p">{</span>
		<span class="k">parent</span><span class="o">::</span><span class="na">assignVariables</span><span class="p">();</span>
		
		<span class="nx">WCF</span><span class="o">::</span><span class="na">getTPL</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">assign</span><span class="p">([</span>
			<span class="s1">'action'</span> <span class="o">=&gt;</span> <span class="s1">'add'</span><span class="p">,</span>
			<span class="s1">'firstName'</span> <span class="o">=&gt;</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">firstName</span><span class="p">,</span>
			<span class="s1">'lastName'</span> <span class="o">=&gt;</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">lastName</span>
		<span class="p">]);</span>
	<span class="p">}</span>
	
	<span class="cd">/**
	 * @inheritDoc
	 */</span>
	<span class="k">public</span> <span class="k">function</span> <span class="nf">readFormParameters</span><span class="p">()</span> <span class="p">{</span>
		<span class="k">parent</span><span class="o">::</span><span class="na">readFormParameters</span><span class="p">();</span>
		
		<span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">'firstName'</span><span class="p">]))</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">firstName</span> <span class="o">=</span> <span class="nx">StringUtil</span><span class="o">::</span><span class="na">trim</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">'firstName'</span><span class="p">]);</span>
		<span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">'lastName'</span><span class="p">]))</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">lastName</span> <span class="o">=</span> <span class="nx">StringUtil</span><span class="o">::</span><span class="na">trim</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">'lastName'</span><span class="p">]);</span>
	<span class="p">}</span>
	
	<span class="cd">/**
	 * @inheritDoc
	 */</span>
	<span class="k">public</span> <span class="k">function</span> <span class="nf">save</span><span class="p">()</span> <span class="p">{</span>
		<span class="k">parent</span><span class="o">::</span><span class="na">save</span><span class="p">();</span>
		
		<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">objectAction</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">PersonAction</span><span class="p">([],</span> <span class="s1">'create'</span><span class="p">,</span> <span class="p">[</span>
			<span class="s1">'data'</span> <span class="o">=&gt;</span> <span class="nb">array_merge</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">additionalFields</span><span class="p">,</span> <span class="p">[</span>
				<span class="s1">'firstName'</span> <span class="o">=&gt;</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">firstName</span><span class="p">,</span>
				<span class="s1">'lastName'</span> <span class="o">=&gt;</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">lastName</span>
			<span class="p">])</span>
		<span class="p">]);</span>
		<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">objectAction</span><span class="o">-&gt;</span><span class="na">executeAction</span><span class="p">();</span>
		
		<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">saved</span><span class="p">();</span>
		
		<span class="c1">// reset values</span>
		<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">firstName</span> <span class="o">=</span> <span class="s1">''</span><span class="p">;</span>
		<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">lastName</span> <span class="o">=</span> <span class="s1">''</span><span class="p">;</span>
		
		<span class="c1">// show success message</span>
		<span class="nx">WCF</span><span class="o">::</span><span class="na">getTPL</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">assign</span><span class="p">(</span><span class="s1">'success'</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
	<span class="p">}</span>
	
	<span class="cd">/**
	 * @inheritDoc
	 */</span>
	<span class="k">public</span> <span class="k">function</span> <span class="nf">validate</span><span class="p">()</span> <span class="p">{</span>
		<span class="k">parent</span><span class="o">::</span><span class="na">validate</span><span class="p">();</span>
		
		<span class="c1">// validate first name</span>
		<span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">firstName</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">throw</span> <span class="k">new</span> <span class="nx">UserInputException</span><span class="p">(</span><span class="s1">'firstName'</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="k">if</span> <span class="p">(</span><span class="nb">mb_strlen</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">firstName</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">255</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">throw</span> <span class="k">new</span> <span class="nx">UserInputException</span><span class="p">(</span><span class="s1">'firstName'</span><span class="p">,</span> <span class="s1">'tooLong'</span><span class="p">);</span>
		<span class="p">}</span>
		
		<span class="c1">// validate last name</span>
		<span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">lastName</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">throw</span> <span class="k">new</span> <span class="nx">UserInputException</span><span class="p">(</span><span class="s1">'lastName'</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="k">if</span> <span class="p">(</span><span class="nb">mb_strlen</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">lastName</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">255</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">throw</span> <span class="k">new</span> <span class="nx">UserInputException</span><span class="p">(</span><span class="s1">'lastName'</span><span class="p">,</span> <span class="s1">'tooLong'</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-php" data-lang="php"><span class="cp">&lt;?php</span>
<span class="kn">namespace</span> <span class="nn">wcf\acp\form</span><span class="p">;</span>
<span class="kn">use</span> <span class="nn">wcf\data\person\Person</span><span class="p">;</span>
<span class="kn">use</span> <span class="nn">wcf\data\person\PersonAction</span><span class="p">;</span>
<span class="kn">use</span> <span class="nn">wcf\form\AbstractForm</span><span class="p">;</span>
<span class="kn">use</span> <span class="nn">wcf\system\exception\IllegalLinkException</span><span class="p">;</span>
<span class="kn">use</span> <span class="nn">wcf\system\WCF</span><span class="p">;</span>

<span class="cd">/**
 * Shows the form to edit an existing person.
 * 
 * @author	Matthias Schmidt
 * @copyright	2001-2019 WoltLab GmbH
 * @license	GNU Lesser General Public License &lt;http://opensource.org/licenses/lgpl-license.php&gt;
 * @package	WoltLabSuite\Core\Acp\Form
 */</span>
<span class="kd">class</span> <span class="nc">PersonEditForm</span> <span class="k">extends</span> <span class="nx">PersonAddForm</span> <span class="p">{</span>
	<span class="cd">/**
	 * @inheritDoc
	 */</span>
	<span class="k">public</span> <span class="nv">$activeMenuItem</span> <span class="o">=</span> <span class="s1">'wcf.acp.menu.link.person'</span><span class="p">;</span>
	
	<span class="cd">/**
	 * edited person object
	 * @var	Person
	 */</span>
	<span class="k">public</span> <span class="nv">$person</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
	
	<span class="cd">/**
	 * id of the edited person
	 * @var	integer
	 */</span>
	<span class="k">public</span> <span class="nv">$personID</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	
	<span class="cd">/**
	 * @inheritDoc
	 */</span>
	<span class="k">public</span> <span class="k">function</span> <span class="nf">assignVariables</span><span class="p">()</span> <span class="p">{</span>
		<span class="k">parent</span><span class="o">::</span><span class="na">assignVariables</span><span class="p">();</span>
		
		<span class="nx">WCF</span><span class="o">::</span><span class="na">getTPL</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">assign</span><span class="p">([</span>
			<span class="s1">'action'</span> <span class="o">=&gt;</span> <span class="s1">'edit'</span><span class="p">,</span>
			<span class="s1">'person'</span> <span class="o">=&gt;</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">person</span>
		<span class="p">]);</span>
	<span class="p">}</span>
	
	<span class="cd">/**
	 * @inheritDoc
	 */</span>
	<span class="k">public</span> <span class="k">function</span> <span class="nf">readData</span><span class="p">()</span> <span class="p">{</span>
		<span class="k">parent</span><span class="o">::</span><span class="na">readData</span><span class="p">();</span>
		
		<span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">))</span> <span class="p">{</span>
			<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">firstName</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">person</span><span class="o">-&gt;</span><span class="na">firstName</span><span class="p">;</span>
			<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">lastName</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">person</span><span class="o">-&gt;</span><span class="na">lastName</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>
	
	<span class="cd">/**
	 * @inheritDoc
	 */</span>
	<span class="k">public</span> <span class="k">function</span> <span class="nf">readParameters</span><span class="p">()</span> <span class="p">{</span>
		<span class="k">parent</span><span class="o">::</span><span class="na">readParameters</span><span class="p">();</span>
		
		<span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">'id'</span><span class="p">]))</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">personID</span> <span class="o">=</span> <span class="nb">intval</span><span class="p">(</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">'id'</span><span class="p">]);</span>
		<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">person</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Person</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">personID</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">person</span><span class="o">-&gt;</span><span class="na">personID</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">throw</span> <span class="k">new</span> <span class="nx">IllegalLinkException</span><span class="p">();</span>
		<span class="p">}</span>
	<span class="p">}</span>
	
	<span class="cd">/**
	 * @inheritDoc
	 */</span>
	<span class="k">public</span> <span class="k">function</span> <span class="nf">save</span><span class="p">()</span> <span class="p">{</span>
		<span class="nx">AbstractForm</span><span class="o">::</span><span class="na">save</span><span class="p">();</span>
		
		<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">objectAction</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">PersonAction</span><span class="p">([</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">person</span><span class="p">],</span> <span class="s1">'update'</span><span class="p">,</span> <span class="p">[</span>
			<span class="s1">'data'</span> <span class="o">=&gt;</span> <span class="nb">array_merge</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">additionalFields</span><span class="p">,</span> <span class="p">[</span>
				<span class="s1">'firstName'</span> <span class="o">=&gt;</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">firstName</span><span class="p">,</span>
				<span class="s1">'lastName'</span> <span class="o">=&gt;</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">lastName</span>
			<span class="p">])</span>
		<span class="p">]);</span>
		<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">objectAction</span><span class="o">-&gt;</span><span class="na">executeAction</span><span class="p">();</span>
		
		<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">saved</span><span class="p">();</span>
		
		<span class="c1">// show success message</span>
		<span class="nx">WCF</span><span class="o">::</span><span class="na">getTPL</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">assign</span><span class="p">(</span><span class="s1">'success'</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
	<span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-php" data-lang="php"><span class="p">{</span><span class="k">include</span> <span class="nb">file</span><span class="o">=</span><span class="s1">'header'</span> <span class="nx">pageTitle</span><span class="o">=</span><span class="s1">'wcf.acp.person.'</span><span class="o">|</span><span class="nx">concat</span><span class="o">:</span><span class="nv">$action</span><span class="p">}</span>

<span class="o">&lt;</span><span class="nb">header</span> <span class="nx">class</span><span class="o">=</span><span class="s2">"contentHeader"</span><span class="o">&gt;</span>
	<span class="o">&lt;</span><span class="nx">div</span> <span class="nx">class</span><span class="o">=</span><span class="s2">"contentHeaderTitle"</span><span class="o">&gt;</span>
		<span class="o">&lt;</span><span class="nx">h1</span> <span class="nx">class</span><span class="o">=</span><span class="s2">"contentTitle"</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">lang</span><span class="p">}</span><span class="nx">wcf</span><span class="o">.</span><span class="nx">acp</span><span class="o">.</span><span class="nx">person</span><span class="o">.</span><span class="p">{</span><span class="nv">$action</span><span class="p">}{</span><span class="o">/</span><span class="nx">lang</span><span class="p">}</span><span class="o">&lt;/</span><span class="nx">h1</span><span class="o">&gt;</span>
	<span class="o">&lt;/</span><span class="nx">div</span><span class="o">&gt;</span>
	
	<span class="o">&lt;</span><span class="nx">nav</span> <span class="nx">class</span><span class="o">=</span><span class="s2">"contentHeaderNavigation"</span><span class="o">&gt;</span>
		<span class="o">&lt;</span><span class="nx">ul</span><span class="o">&gt;</span>
			<span class="o">&lt;</span><span class="nx">li</span><span class="o">&gt;&lt;</span><span class="nx">a</span> <span class="nx">href</span><span class="o">=</span><span class="s2">"{link controller='PersonList'}</span><span class="si">{</span><span class="nv">/link</span><span class="si">}</span><span class="s2">"</span> <span class="nx">class</span><span class="o">=</span><span class="s2">"button"</span><span class="o">&gt;&lt;</span><span class="nx">span</span> <span class="nx">class</span><span class="o">=</span><span class="s2">"icon icon16 fa-list"</span><span class="o">&gt;&lt;/</span><span class="nx">span</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="nx">span</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">lang</span><span class="p">}</span><span class="nx">wcf</span><span class="o">.</span><span class="nx">acp</span><span class="o">.</span><span class="nx">menu</span><span class="o">.</span><span class="nb">link</span><span class="o">.</span><span class="nx">person</span><span class="o">.</span><span class="k">list</span><span class="p">{</span><span class="o">/</span><span class="nx">lang</span><span class="p">}</span><span class="o">&lt;/</span><span class="nx">span</span><span class="o">&gt;&lt;/</span><span class="nx">a</span><span class="o">&gt;&lt;/</span><span class="nx">li</span><span class="o">&gt;</span>
			
			<span class="p">{</span><span class="nx">event</span> <span class="nx">name</span><span class="o">=</span><span class="s1">'contentHeaderNavigation'</span><span class="p">}</span>
		<span class="o">&lt;/</span><span class="nx">ul</span><span class="o">&gt;</span>
	<span class="o">&lt;/</span><span class="nx">nav</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="nb">header</span><span class="o">&gt;</span>

<span class="p">{</span><span class="k">include</span> <span class="nb">file</span><span class="o">=</span><span class="s1">'formError'</span><span class="p">}</span>

<span class="p">{</span><span class="k">if</span> <span class="nv">$success</span><span class="o">|</span><span class="nb">isset</span><span class="p">}</span>
	<span class="o">&lt;</span><span class="nx">p</span> <span class="nx">class</span><span class="o">=</span><span class="s2">"success"</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">lang</span><span class="p">}</span><span class="nx">wcf</span><span class="o">.</span><span class="k">global</span><span class="o">.</span><span class="nx">success</span><span class="o">.</span><span class="p">{</span><span class="nv">$action</span><span class="p">}{</span><span class="o">/</span><span class="nx">lang</span><span class="p">}</span><span class="o">&lt;/</span><span class="nx">p</span><span class="o">&gt;</span>
<span class="p">{</span><span class="o">/</span><span class="k">if</span><span class="p">}</span>

<span class="o">&lt;</span><span class="nx">form</span> <span class="nx">method</span><span class="o">=</span><span class="s2">"post"</span> <span class="nx">action</span><span class="o">=</span><span class="s2">"{if </span><span class="nv">$action</span><span class="s2"> == 'add'}{link controller='PersonAdd'}</span><span class="si">{</span><span class="nv">/link}{else</span><span class="si">}</span><span class="s2">{link controller='PersonEdit' object=</span><span class="nv">$person</span><span class="s2">}</span><span class="si">{</span><span class="nv">/link}{/if</span><span class="si">}</span><span class="s2">"</span><span class="o">&gt;</span>
	<span class="o">&lt;</span><span class="nx">div</span> <span class="nx">class</span><span class="o">=</span><span class="s2">"section"</span><span class="o">&gt;</span>
		<span class="o">&lt;</span><span class="nb">dl</span><span class="p">{</span><span class="k">if</span> <span class="nv">$errorField</span> <span class="o">==</span> <span class="s1">'firstName'</span><span class="p">}</span> <span class="nx">class</span><span class="o">=</span><span class="s2">"formError"</span><span class="p">{</span><span class="o">/</span><span class="k">if</span><span class="p">}</span><span class="o">&gt;</span>
			<span class="o">&lt;</span><span class="nx">dt</span><span class="o">&gt;&lt;</span><span class="nx">label</span> <span class="k">for</span><span class="o">=</span><span class="s2">"firstName"</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">lang</span><span class="p">}</span><span class="nx">wcf</span><span class="o">.</span><span class="nx">person</span><span class="o">.</span><span class="nx">firstName</span><span class="p">{</span><span class="o">/</span><span class="nx">lang</span><span class="p">}</span><span class="o">&lt;/</span><span class="nx">label</span><span class="o">&gt;&lt;/</span><span class="nx">dt</span><span class="o">&gt;</span>
			<span class="o">&lt;</span><span class="nx">dd</span><span class="o">&gt;</span>
				<span class="o">&lt;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="s2">"text"</span> <span class="nx">id</span><span class="o">=</span><span class="s2">"firstName"</span> <span class="nx">name</span><span class="o">=</span><span class="s2">"firstName"</span> <span class="nx">value</span><span class="o">=</span><span class="s2">"</span><span class="si">{</span><span class="nv">$firstName</span><span class="si">}</span><span class="s2">"</span> <span class="nx">required</span> <span class="nx">autofocus</span> <span class="nx">maxlength</span><span class="o">=</span><span class="s2">"255"</span> <span class="nx">class</span><span class="o">=</span><span class="s2">"long"</span><span class="o">&gt;</span>
				<span class="p">{</span><span class="k">if</span> <span class="nv">$errorField</span> <span class="o">==</span> <span class="s1">'firstName'</span><span class="p">}</span>
					<span class="o">&lt;</span><span class="nx">small</span> <span class="nx">class</span><span class="o">=</span><span class="s2">"innerError"</span><span class="o">&gt;</span>
						<span class="p">{</span><span class="k">if</span> <span class="nv">$errorType</span> <span class="o">==</span> <span class="s1">'empty'</span><span class="p">}</span>
							<span class="p">{</span><span class="nx">lang</span><span class="p">}</span><span class="nx">wcf</span><span class="o">.</span><span class="k">global</span><span class="o">.</span><span class="nx">form</span><span class="o">.</span><span class="nx">error</span><span class="o">.</span><span class="k">empty</span><span class="p">{</span><span class="o">/</span><span class="nx">lang</span><span class="p">}</span>
						<span class="p">{</span><span class="k">else</span><span class="p">}</span>
							<span class="p">{</span><span class="nx">lang</span><span class="p">}</span><span class="nx">wcf</span><span class="o">.</span><span class="nx">acp</span><span class="o">.</span><span class="nx">person</span><span class="o">.</span><span class="nx">firstName</span><span class="o">.</span><span class="nx">error</span><span class="o">.</span><span class="p">{</span><span class="nv">$errorType</span><span class="p">}{</span><span class="o">/</span><span class="nx">lang</span><span class="p">}</span>
						<span class="p">{</span><span class="o">/</span><span class="k">if</span><span class="p">}</span>
					<span class="o">&lt;/</span><span class="nx">small</span><span class="o">&gt;</span>
				<span class="p">{</span><span class="o">/</span><span class="k">if</span><span class="p">}</span>
			<span class="o">&lt;/</span><span class="nx">dd</span><span class="o">&gt;</span>
		<span class="o">&lt;/</span><span class="nb">dl</span><span class="o">&gt;</span>
		
		<span class="o">&lt;</span><span class="nb">dl</span><span class="p">{</span><span class="k">if</span> <span class="nv">$errorField</span> <span class="o">==</span> <span class="s1">'lastName'</span><span class="p">}</span> <span class="nx">class</span><span class="o">=</span><span class="s2">"formError"</span><span class="p">{</span><span class="o">/</span><span class="k">if</span><span class="p">}</span><span class="o">&gt;</span>
			<span class="o">&lt;</span><span class="nx">dt</span><span class="o">&gt;&lt;</span><span class="nx">label</span> <span class="k">for</span><span class="o">=</span><span class="s2">"lastName"</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">lang</span><span class="p">}</span><span class="nx">wcf</span><span class="o">.</span><span class="nx">person</span><span class="o">.</span><span class="nx">lastName</span><span class="p">{</span><span class="o">/</span><span class="nx">lang</span><span class="p">}</span><span class="o">&lt;/</span><span class="nx">label</span><span class="o">&gt;&lt;/</span><span class="nx">dt</span><span class="o">&gt;</span>
			<span class="o">&lt;</span><span class="nx">dd</span><span class="o">&gt;</span>
				<span class="o">&lt;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="s2">"text"</span> <span class="nx">id</span><span class="o">=</span><span class="s2">"lastName"</span> <span class="nx">name</span><span class="o">=</span><span class="s2">"lastName"</span> <span class="nx">value</span><span class="o">=</span><span class="s2">"</span><span class="si">{</span><span class="nv">$lastName</span><span class="si">}</span><span class="s2">"</span> <span class="nx">required</span> <span class="nx">maxlength</span><span class="o">=</span><span class="s2">"255"</span> <span class="nx">class</span><span class="o">=</span><span class="s2">"long"</span><span class="o">&gt;</span>
				<span class="p">{</span><span class="k">if</span> <span class="nv">$errorField</span> <span class="o">==</span> <span class="s1">'lastName'</span><span class="p">}</span>
					<span class="o">&lt;</span><span class="nx">small</span> <span class="nx">class</span><span class="o">=</span><span class="s2">"innerError"</span><span class="o">&gt;</span>
						<span class="p">{</span><span class="k">if</span> <span class="nv">$errorType</span> <span class="o">==</span> <span class="s1">'empty'</span><span class="p">}</span>
							<span class="p">{</span><span class="nx">lang</span><span class="p">}</span><span class="nx">wcf</span><span class="o">.</span><span class="k">global</span><span class="o">.</span><span class="nx">form</span><span class="o">.</span><span class="nx">error</span><span class="o">.</span><span class="k">empty</span><span class="p">{</span><span class="o">/</span><span class="nx">lang</span><span class="p">}</span>
						<span class="p">{</span><span class="k">else</span><span class="p">}</span>
							<span class="p">{</span><span class="nx">lang</span><span class="p">}</span><span class="nx">wcf</span><span class="o">.</span><span class="nx">acp</span><span class="o">.</span><span class="nx">person</span><span class="o">.</span><span class="nx">lastName</span><span class="o">.</span><span class="nx">error</span><span class="o">.</span><span class="p">{</span><span class="nv">$errorType</span><span class="p">}{</span><span class="o">/</span><span class="nx">lang</span><span class="p">}</span>
						<span class="p">{</span><span class="o">/</span><span class="k">if</span><span class="p">}</span>
					<span class="o">&lt;/</span><span class="nx">small</span><span class="o">&gt;</span>
				<span class="p">{</span><span class="o">/</span><span class="k">if</span><span class="p">}</span>
			<span class="o">&lt;/</span><span class="nx">dd</span><span class="o">&gt;</span>
		<span class="o">&lt;/</span><span class="nb">dl</span><span class="o">&gt;</span>
		
		<span class="p">{</span><span class="nx">event</span> <span class="nx">name</span><span class="o">=</span><span class="s1">'dataFields'</span><span class="p">}</span>
	<span class="o">&lt;/</span><span class="nx">div</span><span class="o">&gt;</span>
	
	<span class="p">{</span><span class="nx">event</span> <span class="nx">name</span><span class="o">=</span><span class="s1">'sections'</span><span class="p">}</span>
	
	<span class="o">&lt;</span><span class="nx">div</span> <span class="nx">class</span><span class="o">=</span><span class="s2">"formSubmit"</span><span class="o">&gt;</span>
		<span class="o">&lt;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="s2">"submit"</span> <span class="nx">value</span><span class="o">=</span><span class="s2">"</span><span class="si">{</span><span class="nv">lang}wcf.global.button.submit{/lang</span><span class="si">}</span><span class="s2">"</span> <span class="nx">accesskey</span><span class="o">=</span><span class="s2">"s"</span><span class="o">&gt;</span>
		<span class="p">{</span><span class="o">@</span><span class="nx">SECURITY_TOKEN_INPUT_TAG</span><span class="p">}</span>
	<span class="o">&lt;/</span><span class="nx">div</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="nx">form</span><span class="o">&gt;</span>

<span class="p">{</span><span class="k">include</span> <span class="nb">file</span><span class="o">=</span><span class="s1">'footer'</span><span class="p">}</span></code></pre></figure>

<p>Updating the template is easy as the complete form is replace by a single line of code:</p>

<figure class="highlight"><pre><code class="language-php" data-lang="php"><span class="p">{</span><span class="k">include</span> <span class="nb">file</span><span class="o">=</span><span class="s1">'header'</span> <span class="nx">pageTitle</span><span class="o">=</span><span class="s1">'wcf.acp.person.'</span><span class="o">|</span><span class="nx">concat</span><span class="o">:</span><span class="nv">$action</span><span class="p">}</span>

<span class="o">&lt;</span><span class="nb">header</span> <span class="nx">class</span><span class="o">=</span><span class="s2">"contentHeader"</span><span class="o">&gt;</span>
	<span class="o">&lt;</span><span class="nx">div</span> <span class="nx">class</span><span class="o">=</span><span class="s2">"contentHeaderTitle"</span><span class="o">&gt;</span>
		<span class="o">&lt;</span><span class="nx">h1</span> <span class="nx">class</span><span class="o">=</span><span class="s2">"contentTitle"</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">lang</span><span class="p">}</span><span class="nx">wcf</span><span class="o">.</span><span class="nx">acp</span><span class="o">.</span><span class="nx">person</span><span class="o">.</span><span class="p">{</span><span class="nv">$action</span><span class="p">}{</span><span class="o">/</span><span class="nx">lang</span><span class="p">}</span><span class="o">&lt;/</span><span class="nx">h1</span><span class="o">&gt;</span>
	<span class="o">&lt;/</span><span class="nx">div</span><span class="o">&gt;</span>
	
	<span class="o">&lt;</span><span class="nx">nav</span> <span class="nx">class</span><span class="o">=</span><span class="s2">"contentHeaderNavigation"</span><span class="o">&gt;</span>
		<span class="o">&lt;</span><span class="nx">ul</span><span class="o">&gt;</span>
			<span class="o">&lt;</span><span class="nx">li</span><span class="o">&gt;&lt;</span><span class="nx">a</span> <span class="nx">href</span><span class="o">=</span><span class="s2">"{link controller='PersonList'}</span><span class="si">{</span><span class="nv">/link</span><span class="si">}</span><span class="s2">"</span> <span class="nx">class</span><span class="o">=</span><span class="s2">"button"</span><span class="o">&gt;&lt;</span><span class="nx">span</span> <span class="nx">class</span><span class="o">=</span><span class="s2">"icon icon16 fa-list"</span><span class="o">&gt;&lt;/</span><span class="nx">span</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="nx">span</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">lang</span><span class="p">}</span><span class="nx">wcf</span><span class="o">.</span><span class="nx">acp</span><span class="o">.</span><span class="nx">menu</span><span class="o">.</span><span class="nb">link</span><span class="o">.</span><span class="nx">person</span><span class="o">.</span><span class="k">list</span><span class="p">{</span><span class="o">/</span><span class="nx">lang</span><span class="p">}</span><span class="o">&lt;/</span><span class="nx">span</span><span class="o">&gt;&lt;/</span><span class="nx">a</span><span class="o">&gt;&lt;/</span><span class="nx">li</span><span class="o">&gt;</span>
			
			<span class="p">{</span><span class="nx">event</span> <span class="nx">name</span><span class="o">=</span><span class="s1">'contentHeaderNavigation'</span><span class="p">}</span>
		<span class="o">&lt;/</span><span class="nx">ul</span><span class="o">&gt;</span>
	<span class="o">&lt;/</span><span class="nx">nav</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="nb">header</span><span class="o">&gt;</span>

<span class="p">{</span><span class="o">@</span><span class="nv">$form</span><span class="o">-&gt;</span><span class="na">getHtml</span><span class="p">()}</span>

<span class="p">{</span><span class="k">include</span> <span class="nb">file</span><span class="o">=</span><span class="s1">'footer'</span><span class="p">}</span></code></pre></figure>

<p><code class="language-plaintext highlighter-rouge">PersonEditForm</code> also becomes much simpler:
only the edited <code class="language-plaintext highlighter-rouge">Person</code> object must be read:</p>

<figure class="highlight"><pre><code class="language-php" data-lang="php"><span class="cp">&lt;?php</span>
<span class="kn">namespace</span> <span class="nn">wcf\acp\form</span><span class="p">;</span>
<span class="kn">use</span> <span class="nn">wcf\data\person\Person</span><span class="p">;</span>
<span class="kn">use</span> <span class="nn">wcf\system\exception\IllegalLinkException</span><span class="p">;</span>

<span class="cd">/**
 * Shows the form to edit an existing person.
 * 
 * @author	Matthias Schmidt
 * @copyright	2001-2019 WoltLab GmbH
 * @license	GNU Lesser General Public License &lt;http://opensource.org/licenses/lgpl-license.php&gt;
 * @package	WoltLabSuite\Core\Acp\Form
 */</span>
<span class="kd">class</span> <span class="nc">PersonEditForm</span> <span class="k">extends</span> <span class="nx">PersonAddForm</span> <span class="p">{</span>
	<span class="cd">/**
	 * @inheritDoc
	 */</span>
	<span class="k">public</span> <span class="nv">$activeMenuItem</span> <span class="o">=</span> <span class="s1">'wcf.acp.menu.link.person'</span><span class="p">;</span>
	
	<span class="cd">/**
	 * @inheritDoc
	 */</span>
	<span class="k">public</span> <span class="k">function</span> <span class="nf">readParameters</span><span class="p">()</span> <span class="p">{</span>
		<span class="k">parent</span><span class="o">::</span><span class="na">readParameters</span><span class="p">();</span>
		
		<span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">'id'</span><span class="p">]))</span> <span class="p">{</span>
			<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">formObject</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Person</span><span class="p">(</span><span class="nb">intval</span><span class="p">(</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">'id'</span><span class="p">]));</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">formObject</span><span class="o">-&gt;</span><span class="na">personID</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">throw</span> <span class="k">new</span> <span class="nx">IllegalLinkException</span><span class="p">();</span>
			<span class="p">}</span>
		<span class="p">}</span>
	<span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<p>Most of the work is done in <code class="language-plaintext highlighter-rouge">PersonAddForm</code>:</p>

<figure class="highlight"><pre><code class="language-php" data-lang="php"><span class="cp">&lt;?php</span>
<span class="kn">namespace</span> <span class="nn">wcf\acp\form</span><span class="p">;</span>
<span class="kn">use</span> <span class="nn">wcf\data\person\PersonAction</span><span class="p">;</span>
<span class="kn">use</span> <span class="nn">wcf\form\AbstractFormBuilderForm</span><span class="p">;</span>
<span class="kn">use</span> <span class="nn">wcf\system\form\builder\container\FormContainer</span><span class="p">;</span>
<span class="kn">use</span> <span class="nn">wcf\system\form\builder\field\TextFormField</span><span class="p">;</span>

<span class="cd">/**
 * Shows the form to create a new person.
 * 
 * @author	Matthias Schmidt
 * @copyright	2001-2019 WoltLab GmbH
 * @license	GNU Lesser General Public License &lt;http://opensource.org/licenses/lgpl-license.php&gt;
 * @package	WoltLabSuite\Core\Acp\Form
 */</span>
<span class="kd">class</span> <span class="nc">PersonAddForm</span> <span class="k">extends</span> <span class="nx">AbstractFormBuilderForm</span> <span class="p">{</span>
	<span class="cd">/**
	 * @inheritDoc
	 */</span>
	<span class="k">public</span> <span class="nv">$activeMenuItem</span> <span class="o">=</span> <span class="s1">'wcf.acp.menu.link.person.add'</span><span class="p">;</span>
	
	<span class="cd">/**
	 * @inheritDoc
	 */</span>
	<span class="k">public</span> <span class="nv">$formAction</span> <span class="o">=</span> <span class="s1">'create'</span><span class="p">;</span>
	
	<span class="cd">/**
	 * @inheritDoc
	 */</span>
	<span class="k">public</span> <span class="nv">$neededPermissions</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'admin.content.canManagePeople'</span><span class="p">];</span>
	
	<span class="cd">/**
	 * @inheritDoc
	 */</span>
	<span class="k">public</span> <span class="nv">$objectActionClass</span> <span class="o">=</span> <span class="nx">PersonAction</span><span class="o">::</span><span class="na">class</span><span class="p">;</span>
	
	<span class="cd">/**
	 * @inheritDoc
	 */</span>
	<span class="k">protected</span> <span class="k">function</span> <span class="nf">createForm</span><span class="p">()</span> <span class="p">{</span>
		<span class="k">parent</span><span class="o">::</span><span class="na">createForm</span><span class="p">();</span>
		
		<span class="nv">$dataContainer</span> <span class="o">=</span> <span class="nx">FormContainer</span><span class="o">::</span><span class="na">create</span><span class="p">(</span><span class="s1">'data'</span><span class="p">)</span>
			<span class="o">-&gt;</span><span class="na">appendChildren</span><span class="p">([</span>
				<span class="nx">TextFormField</span><span class="o">::</span><span class="na">create</span><span class="p">(</span><span class="s1">'firstName'</span><span class="p">)</span>
					<span class="o">-&gt;</span><span class="na">label</span><span class="p">(</span><span class="s1">'wcf.person.firstName'</span><span class="p">)</span>
					<span class="o">-&gt;</span><span class="na">required</span><span class="p">()</span>
					<span class="o">-&gt;</span><span class="na">maximumLength</span><span class="p">(</span><span class="mi">255</span><span class="p">),</span>
				
				<span class="nx">TextFormField</span><span class="o">::</span><span class="na">create</span><span class="p">(</span><span class="s1">'lastName'</span><span class="p">)</span>
					<span class="o">-&gt;</span><span class="na">label</span><span class="p">(</span><span class="s1">'wcf.person.lastName'</span><span class="p">)</span>
					<span class="o">-&gt;</span><span class="na">required</span><span class="p">()</span>
					<span class="o">-&gt;</span><span class="na">maximumLength</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span>
			<span class="p">]);</span>
		
		<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">form</span><span class="o">-&gt;</span><span class="na">appendChild</span><span class="p">(</span><span class="nv">$dataContainer</span><span class="p">);</span>
	<span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<p>But, as you can see, the number of lines almost decreased by half.
All changes are due to extending <code class="language-plaintext highlighter-rouge">AbstractFormBuilderForm</code>:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">$formAction</code> is added and set to <code class="language-plaintext highlighter-rouge">create</code> as the form is used to create a new person.
In the edit form, <code class="language-plaintext highlighter-rouge">$formAction</code> has not to be set explicitly as it is done automatically if a <code class="language-plaintext highlighter-rouge">$formObject</code> is set.</li>
  <li><code class="language-plaintext highlighter-rouge">$objectActionClass</code> is set to <code class="language-plaintext highlighter-rouge">PersonAction::class</code> and is the class name of the used <code class="language-plaintext highlighter-rouge">AbstractForm::$objectAction</code> object to create and update the <code class="language-plaintext highlighter-rouge">Person</code> object.</li>
  <li><code class="language-plaintext highlighter-rouge">AbstractFormBuilderForm::createForm()</code> is overridden and the form contents are added:
a form container representing the <code class="language-plaintext highlighter-rouge">div.section</code> element from the old version and the two form fields with the same ids and labels as before.
The contents of the old <code class="language-plaintext highlighter-rouge">validate()</code> method is put into two method calls:
<code class="language-plaintext highlighter-rouge">required()</code> to ensure that the form is filled out and <code class="language-plaintext highlighter-rouge">maximumLength(255)</code> to ensure that the names are not longer than 255 characters.</li>
</ul>


    <div class="tags">
        
    </div>

    

</div>

      </div>
    </div>
  </div>

  <div class="footerBox">
    <div class="container">
      <div class="footerBoxLeft">
        
        <a target="_blank" href="https://github.com/woltlab/woltlab.github.io/blob/master/pages/migration/wsc-31/migration_wsc-31_form-builder.md" class="btn btn-default githubEditButton no_icon" role="button"><i class="fa fa-github fa-lg"></i> Edit on GitHub</a>
        <p>Site last generated: Jul 9, 2021</p>
      </div>
      <div class="footerBoxRight">
        <a class="no_icon" href="https://www.woltlab.com"><img src="https://docs.woltlab.com/5.3/images/woltlab-black.png" srcset="https://docs.woltlab.com/5.3/images/woltlab-black@2x.png 2x" height="40" width="204" alt=""></a>
      </div>
    </div>
  </div>

  <div class="pageFooter">
    <div class="container">
      &copy; 2001  2021 <a class="no_icon" href="https://www.woltlab.com">WoltLab GmbH</a>. All rights reserved. | <a class="no_icon" href="https://www.woltlab.com/legal-notice/">Legal Notice</a> | <a class="no_icon" href="https://www.woltlab.com/privacy-policy/">Privacy Policy</a>
    </div>
  </div>
</body>

</html>
